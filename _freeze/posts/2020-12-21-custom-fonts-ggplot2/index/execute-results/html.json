{
  "hash": "5edb4243e78cf5380b0b7f9009b2b1ad",
  "result": {
    "markdown": "---\ntitle: How to use custom typefaces in ggplot2 [macOS only]\nauthor: Stefano Coretta\ndate: '2020-12-21'\n\ncategories:\n  - Methods\ntags:\n  - data viz\n  - ggplot2\n  - ipa\n  - typefaces\n  - fonts\n---\n\n\nI keep hitting my head against this particular (and seemingly simple) task: **using custom typefaces in ggplot2 plots** and **being able to knit to PDF**.\n\nThe main reason for why I would want to do that is that I often find myself in need of including [IPA](https://www.internationalphoneticassociation.org/content/ipa-chart) symbols in plots (more often than not, it's vowels) and that I want those plots to be included in a knitted PDF.\n\nFor some reason, when I think I got it, I have to search again because the solution I previously found no longer works.\n\nSo now I took the time to play around with different options and packages, and I found the minimal configuration one needs to use custom typefaces in ggplot2 plots and get a PDF document with those plots embedded in it (it is working as of December 2020, not sure what the year will bring).\n\nIn the following sections I will show what this configuration looks like.\nNote that this post covers only R running on macOS and that things will be different perhaps on Linux and for sure on Windows (maybe I'll cover those OSs in an update later on).\n\nYou can check out my full session info below, but just be aware that I am using R 4.0.3 in macOS Big Sur 11.1, with the latest version of the tidyverse packages at the time of writing.\n\n## Enable custom typefaces in ggplot2 plots when knitting to PDF\n\nI was surprised to find out that to include custom typefaces in ggplot2 plots and knit the `.Rmd` to a PDF document, you just need the following options in your YAML preamble (no need for extra packages!!!).\n\n\n::: {.cell}\n\n```{.r .cell-code}\n---\noutput:\n  pdf_document:\n    latex_engine: xelatex\n    dev: cairo_pdf\n---\n```\n:::\n\n\nIn particular, the `dev` option sets `cairo_pdf()` (shipped with ggplot2) as the default device for rendering the plots within the knitted PDF document.\n\nAs Miranda Priestly would say, *that's all...*^[<https://media.giphy.com/media/3o6gDY8zzwvNQdFCaQ/giphy.gif>]\n\nWithin your document you can then specify the typeface you want to use in the plots.\nThe most straightforward way is to set a ggplot2 theme and specify the `base_family` argument.\n\n\n::: {.cell}\n\n:::\n\n\nI chose the [Fira Sans](https://fonts.google.com/specimen/Fira+Sans) fonts here because they include the Unicode range of the IPA.\n\nBoth when running a chunk with a ggplot2 plot interactively in the `.Rmd` file and when knitting the `.Rmd` to a PDF, the plot typeface will be Fira Sans.\nAnd we are done.\n\n## Extra: Saving ggplot2 plots to a file\n\nNow, what if you want to save the plots with your custom typeface to a file that you can include in another document?\n\nYou have two options:\n\n- You can save the plot as a standalone PDF file (with embedded fonts).\n- Or you can save the plot as a `.png` image.\n\nAchieving that is quite simple with `ggsave()`:\n\n\n::: {.cell}\n\n:::\n\n\nThe magic is done by `ggsave(..., device = cairo_pdf)` (that's the same `cairo_pdf` device we set in the YAML preamble).\nNote that it's `cairo_pdf` and not `cairo_pdf()` (for reasons beyond my comprehension, it does not work if you add the parentheses).\n\nHere you find a [gist](https://gist.github.com/stefanocoretta/c9e3c0d8a72739c7ebb3a30d11e4c134) with an example `.Rmd` file that you can download on your machine and knit as a test.\n\n\n## Supported fonts\n\nAs far as I can tell, any `.ttf` (TrueType font) installed on your system with Font Book can be set as the typeface to be used in the ggplot2 plots.\n\n\n## Session info\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.3.2 (2023-10-31)\n os       macOS Sonoma 14.0\n system   aarch64, darwin20\n ui       X11\n language (EN)\n collate  en_US.UTF-8\n ctype    en_US.UTF-8\n tz       Europe/London\n date     2023-12-25\n pandoc   3.1.11 @ /opt/homebrew/bin/ (via rmarkdown)\n\n─ Packages ───────────────────────────────────────────────────────────────────\n ! package     * version date (UTC) lib source\n P cachem        1.0.8   2023-05-01 [?] CRAN (R 4.3.0)\n P callr         3.7.3   2022-11-02 [?] CRAN (R 4.3.0)\n P cli           3.6.2   2023-12-11 [?] RSPM (R 4.3.0)\n P crayon        1.5.2   2022-09-29 [?] CRAN (R 4.3.0)\n P devtools      2.4.5   2022-10-11 [?] CRAN (R 4.3.0)\n P digest        0.6.33  2023-07-07 [?] CRAN (R 4.3.0)\n P ellipsis      0.3.2   2021-04-29 [?] CRAN (R 4.3.0)\n P evaluate      0.22    2023-09-29 [?] CRAN (R 4.3.1)\n P fastmap       1.1.1   2023-02-24 [?] CRAN (R 4.3.0)\n P fs            1.6.3   2023-07-20 [?] CRAN (R 4.3.0)\n P glue          1.6.2   2022-02-24 [?] CRAN (R 4.3.0)\n P htmltools     0.5.7   2023-11-03 [?] CRAN (R 4.3.1)\n P htmlwidgets   1.6.2   2023-03-17 [?] CRAN (R 4.3.0)\n P httpuv        1.6.11  2023-05-11 [?] CRAN (R 4.3.0)\n P jsonlite      1.8.7   2023-06-29 [?] CRAN (R 4.3.0)\n P knitr         1.44    2023-09-11 [?] CRAN (R 4.3.0)\n P later         1.3.1   2023-05-02 [?] CRAN (R 4.3.0)\n P lifecycle     1.0.4   2023-11-07 [?] CRAN (R 4.3.1)\n P magrittr      2.0.3   2022-03-30 [?] CRAN (R 4.3.0)\n P memoise       2.0.1   2021-11-26 [?] CRAN (R 4.3.0)\n P mime          0.12    2021-09-28 [?] CRAN (R 4.3.0)\n P miniUI        0.1.1.1 2018-05-18 [?] CRAN (R 4.3.0)\n P pkgbuild      1.4.2   2023-06-26 [?] CRAN (R 4.3.0)\n P pkgload       1.3.3   2023-09-22 [?] CRAN (R 4.3.1)\n P prettyunits   1.2.0   2023-09-24 [?] CRAN (R 4.3.1)\n P processx      3.8.2   2023-06-30 [?] CRAN (R 4.3.0)\n P profvis       0.3.8   2023-05-02 [?] CRAN (R 4.3.0)\n P promises      1.2.1   2023-08-10 [?] CRAN (R 4.3.0)\n P ps            1.7.5   2023-04-18 [?] CRAN (R 4.3.0)\n P purrr         1.0.2   2023-08-10 [?] CRAN (R 4.3.0)\n P R6            2.5.1   2021-08-19 [?] CRAN (R 4.3.0)\n P Rcpp          1.0.11  2023-07-06 [?] CRAN (R 4.3.0)\n P remotes       2.4.2.1 2023-07-18 [?] CRAN (R 4.3.0)\n   renv          1.0.3   2023-09-19 [1] CRAN (R 4.3.1)\n P rlang         1.1.2   2023-11-04 [?] CRAN (R 4.3.1)\n P rmarkdown     2.25    2023-09-18 [?] CRAN (R 4.3.1)\n P rstudioapi    0.15.0  2023-07-07 [?] CRAN (R 4.3.0)\n P sessioninfo   1.2.2   2021-12-06 [?] CRAN (R 4.3.0)\n P shiny         1.7.5.1 2023-10-14 [?] CRAN (R 4.3.1)\n P stringi       1.7.12  2023-01-11 [?] CRAN (R 4.3.0)\n P stringr       1.5.0   2022-12-02 [?] CRAN (R 4.3.0)\n P urlchecker    1.0.1   2021-11-30 [?] CRAN (R 4.3.0)\n P usethis       2.2.2   2023-07-06 [?] CRAN (R 4.3.0)\n P vctrs         0.6.5   2023-12-01 [?] CRAN (R 4.3.1)\n P xfun          0.40    2023-08-09 [?] CRAN (R 4.3.0)\n P xtable        1.8-4   2019-04-21 [?] CRAN (R 4.3.0)\n P yaml          2.3.8   2023-12-11 [?] RSPM (R 4.3.0)\n\n [1] /Users/ste/repos/stefanocoretta.github.io/renv/library/R-4.3/aarch64-apple-darwin20\n [2] /Users/ste/Library/Caches/org.R-project.R/R/renv/sandbox/R-4.3/aarch64-apple-darwin20/ac5c2659\n\n P ── Loaded and on-disk path mismatch.\n\n──────────────────────────────────────────────────────────────────────────────\n```\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}