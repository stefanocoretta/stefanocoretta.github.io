---
title: How to use custom typefaces in ggplot2 [macOS only]
author: Stefano Coretta
date: '2020-12-21'
slug: custom-fonts-ggplot2
categories:
  - Methods
tags:
  - data viz
  - ggplot2
  - ipa
  - typefaces
  - fonts
---



<p>I keep hitting my head against this particular (and seemingly simple) task: <strong>using custom typefaces in ggplot2 plots</strong> and <strong>being able to knit to PDF</strong>.</p>
<p>The main reason for why I would want to do that is that I often find myself in need of including <a href="https://www.internationalphoneticassociation.org/content/ipa-chart">IPA</a> symbols in plots (more often than not, it’s vowels) and that I want those plots to be included in a knitted PDF.</p>
<p>For some reason, when I think I got it, I have to search again because the solution I previously found no longer works.</p>
<p>So now I took the time to play around with different options and packages, and I found the minimal configuration one needs to use custom typefaces in ggplot2 plots and get a PDF document with those plots embedded in it (it is working as of December 2020, not sure what the year will bring).</p>
<p>In the following sections I will show what this configuration looks like.
Note that this post covers only R running on macOS and that things will be different perhaps on Linux and for sure on Windows (maybe I’ll cover those OSs in an update later on).</p>
<p>You can check out my full session info below, but just be aware that I am using R 4.0.3 in macOS Big Sur 11.1, with the latest version of the tidyverse packages at the time of writing.</p>
<div id="enable-custom-typefaces-in-ggplot2-plots-when-knitting-to-pdf" class="section level2">
<h2>Enable custom typefaces in ggplot2 plots when knitting to PDF</h2>
<p>I was surprised to find out that to include custom typefaces in ggplot2 plots and knit the <code>.Rmd</code> to a PDF document, you just need the following options in your YAML preamble (no need for extra packages!!!).</p>
<pre class="r"><code>---
output:
  pdf_document:
    latex_engine: xelatex
    dev: cairo_pdf
---</code></pre>
<p>In particular, the <code>dev</code> option sets <code>cairo_pdf()</code> (shipped with ggplot2) as the default device for rendering the plots within the knitted PDF document.</p>
<p>As Miranda Priestly would say, <em>that’s all…</em><a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a></p>
<p>Within your document you can then specify the typeface you want to use in the plots.
The most straightforward way is to set a ggplot2 theme and specify the <code>base_family</code> argument.</p>
<pre class="r"><code>library(tidyverse) # or library(ggplot2)
theme_set(theme_light(base_family = &quot;Fira Sans&quot;))</code></pre>
<p>I chose the <a href="https://fonts.google.com/specimen/Fira+Sans">Fira Sans</a> fonts here because they include the Unicode range of the IPA.</p>
<p>Both when running a chunk with a ggplot2 plot interactively in the <code>.Rmd</code> file and when knitting the <code>.Rmd</code> to a PDF, the plot typeface will be Fira Sans.
And we are done.</p>
</div>
<div id="extra-saving-ggplot2-plots-to-a-file" class="section level2">
<h2>Extra: Saving ggplot2 plots to a file</h2>
<p>Now, what if you want to save the plots with your custom typeface to a file that you can include in another document?</p>
<p>You have two options:</p>
<ul>
<li>You can save the plot as a standalone PDF file (with embedded fonts).</li>
<li>Or you can save the plot as a <code>.png</code> image.</li>
</ul>
<p>Achieving that is quite simple with <code>ggsave()</code>:</p>
<pre class="r"><code># let&#39;s prepare a plot which will use our custom fonts
p &lt;- ggplot(mpg, aes(class)) +
  geom_bar()

# save to pdf
ggsave(p, &quot;./plot.pdf&quot;, device = cairo_pdf, width = 7, height = 5)

# save to png
ggsave(p, &quot;./plot.png&quot;, width = 7, height = 5)</code></pre>
<p>The magic is done by <code>ggsave(..., device = cairo_pdf)</code> (that’s the same <code>cairo_pdf</code> device we set in the YAML preamble).
Note that it’s <code>cairo_pdf</code> and not <code>cairo_pdf()</code> (for reasons beyond my comprehension, it does not work if you add the parentheses).</p>
<p>Here you find a <a href="https://gist.github.com/stefanocoretta/c9e3c0d8a72739c7ebb3a30d11e4c134">gist</a> with an example <code>.Rmd</code> file that you can download on your machine and knit as a test.</p>
</div>
<div id="supported-fonts" class="section level2">
<h2>Supported fonts</h2>
<p>As far as I can tell, any <code>.ttf</code> (TrueType font) installed on your system with Font Book can be set as the typeface to be used in the ggplot2 plots.</p>
</div>
<div id="session-info" class="section level2">
<h2>Session info</h2>
<pre class="r"><code>devtools::session_info()</code></pre>
<pre><code>## ─ Session info ───────────────────────────────────────────────────────────────────────────────────────────────────────
##  setting  value
##  version  R version 4.1.3 (2022-03-10)
##  os       macOS Monterey 12.3.1
##  system   aarch64, darwin20
##  ui       X11
##  language (EN)
##  collate  en_US.UTF-8
##  ctype    en_US.UTF-8
##  tz       Europe/London
##  date     2022-04-05
##  pandoc   2.17.1.1 @ /opt/homebrew/bin/ (via rmarkdown)
## 
## ─ Packages ───────────────────────────────────────────────────────────────────────────────────────────────────────────
##  ! package     * version date (UTC) lib source
##  P blogdown      1.9     2022-03-28 [?] CRAN (R 4.1.1)
##  P bookdown      0.25    2022-03-16 [?] CRAN (R 4.1.1)
##  P brio          1.1.3   2021-11-30 [?] CRAN (R 4.1.1)
##    bslib         0.3.1   2021-10-06 [2] CRAN (R 4.1.1)
##  P cachem        1.0.6   2021-08-19 [?] CRAN (R 4.1.1)
##  P callr         3.7.0   2021-04-20 [?] CRAN (R 4.1.0)
##  P cli           3.2.0   2022-02-14 [?] CRAN (R 4.1.1)
##  P crayon        1.5.1   2022-03-26 [?] CRAN (R 4.1.3)
##  P desc          1.4.1   2022-03-06 [?] CRAN (R 4.1.1)
##  P devtools      2.4.3   2021-11-30 [?] CRAN (R 4.1.1)
##  P digest        0.6.29  2021-12-01 [?] CRAN (R 4.1.1)
##  P ellipsis      0.3.2   2021-04-29 [?] CRAN (R 4.1.0)
##  P evaluate      0.15    2022-02-18 [?] CRAN (R 4.1.1)
##  P fastmap       1.1.0   2021-01-25 [?] CRAN (R 4.1.0)
##  P fs            1.5.2   2021-12-08 [?] CRAN (R 4.1.1)
##  P glue          1.6.2   2022-02-24 [?] CRAN (R 4.1.1)
##  P htmltools     0.5.2   2021-08-25 [?] CRAN (R 4.1.1)
##  P jquerylib     0.1.4   2021-04-26 [?] CRAN (R 4.1.0)
##  P jsonlite      1.8.0   2022-02-22 [?] CRAN (R 4.1.1)
##  P knitr         1.38    2022-03-25 [?] CRAN (R 4.1.1)
##  P lifecycle     1.0.1   2021-09-24 [?] CRAN (R 4.1.1)
##  P magrittr      2.0.3   2022-03-30 [?] CRAN (R 4.1.1)
##  P memoise       2.0.1   2021-11-26 [?] CRAN (R 4.1.1)
##  P pkgbuild      1.3.1   2021-12-20 [?] CRAN (R 4.1.1)
##  P pkgload       1.2.4   2021-11-30 [?] CRAN (R 4.1.1)
##  P prettyunits   1.1.1   2020-01-24 [?] CRAN (R 4.1.0)
##  P processx      3.5.3   2022-03-25 [?] CRAN (R 4.1.1)
##  P ps            1.6.0   2021-02-28 [?] CRAN (R 4.1.0)
##  P purrr         0.3.4   2020-04-17 [?] CRAN (R 4.1.0)
##  P R6            2.5.1   2021-08-19 [?] CRAN (R 4.1.1)
##  P remotes       2.4.2   2021-11-30 [?] CRAN (R 4.1.1)
##  P renv          0.15.4  2022-03-03 [?] CRAN (R 4.1.1)
##  P rlang         1.0.2   2022-03-04 [?] CRAN (R 4.1.1)
##  P rmarkdown     2.13    2022-03-10 [?] CRAN (R 4.1.1)
##  P rprojroot     2.0.3   2022-04-02 [?] CRAN (R 4.1.3)
##    sass          0.4.1   2022-03-23 [2] CRAN (R 4.1.1)
##  P sessioninfo   1.2.2   2021-12-06 [?] CRAN (R 4.1.1)
##  P stringi       1.7.6   2021-11-29 [?] CRAN (R 4.1.1)
##  P stringr       1.4.0   2019-02-10 [?] CRAN (R 4.1.1)
##  P testthat      3.1.3   2022-03-29 [?] CRAN (R 4.1.3)
##  P usethis       2.1.5   2021-12-09 [?] CRAN (R 4.1.1)
##  P withr         2.5.0   2022-03-03 [?] CRAN (R 4.1.1)
##  P xfun          0.30    2022-03-02 [?] CRAN (R 4.1.1)
##  P yaml          2.3.5   2022-02-21 [?] CRAN (R 4.1.1)
## 
##  [1] /Users/ste/repos/stefanocoretta.github.io/renv/library/R-4.1/aarch64-apple-darwin20
##  [2] /Library/Frameworks/R.framework/Versions/4.1-arm64/Resources/library
## 
##  P ── Loaded and on-disk path mismatch.
## 
## ──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────</code></pre>
</div>
<div class="footnotes footnotes-end-of-document">
<hr />
<ol>
<li id="fn1"><p><a href="https://media.giphy.com/media/3o6gDY8zzwvNQdFCaQ/giphy.gif" class="uri">https://media.giphy.com/media/3o6gDY8zzwvNQdFCaQ/giphy.gif</a><a href="#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
