---
title: How to use custom typefaces in ggplot2 [macOS only]
author: Stefano Coretta
date: '2020-12-21'
slug: custom-fonts-ggplot2
categories:
  - Methods
tags:
  - data viz
  - ggplot2
  - ipa
  - typefaces
  - fonts
---



<p>I keep hitting my head against this particular (and seemingly simple) task: <strong>using custom typefaces in ggplot2 plots</strong> and <strong>being able to knit to PDF</strong>.</p>
<p>The main reason for why I would want to do that is that I often find myself in need of including <a href="https://www.internationalphoneticassociation.org/content/ipa-chart">IPA</a> symbols in plots (more often than not, it’s vowels) and that I want those plots to be included in a knitted PDF.</p>
<p>For some reason, when I think I got it, I have to search again because the solution I previously found no longer works.</p>
<p>So now I took the time to play around with different options and packages, and I found the minimal configuration one needs to use custom typefaces in ggplot2 plots and get a PDF document with those plots embedded in it (it is working as of December 2020, not sure what the year will bring).</p>
<p>In the following sections I will show what this configuration looks like.
Note that this post covers only R running on macOS and that things will be different perhaps on Linux and for sure on Windows (maybe I’ll cover those OSs in an update later on).</p>
<p>You can check out my full session info below, but just be aware that I am using R 4.0.3 in macOS Big Sur 11.1, with the latest version of the tidyverse packages at the time of writing.</p>
<div id="enable-custom-typefaces-in-ggplot2-plots-when-knitting-to-pdf" class="section level2">
<h2>Enable custom typefaces in ggplot2 plots when knitting to PDF</h2>
<p>I was surprised to find out that to include custom typefaces in ggplot2 plots and knit the <code>.Rmd</code> to a PDF document, you just need the following options in your YAML preamble (no need for extra packages!!!).</p>
<pre class="r"><code>---
output:
  pdf_document:
    latex_engine: xelatex
    dev: cairo_pdf
---</code></pre>
<p>In particular, the <code>dev</code> option sets <code>cairo_pdf()</code> (shipped with ggplot2) as the default device for rendering the plots within the knitted PDF document.</p>
<p>As Miranda Priestly would say, <em>that’s all…</em><a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a></p>
<p>Within your document you can then specify the typeface you want to use in the plots.
The most straightforward way is to set a ggplot2 theme and specify the <code>base_family</code> argument.</p>
<pre class="r"><code>library(tidyverse) # or library(ggplot2)
theme_set(theme_light(base_family = &quot;Fira Sans&quot;))</code></pre>
<p>I chose the <a href="https://fonts.google.com/specimen/Fira+Sans">Fira Sans</a> fonts here because they include the Unicode range of the IPA.</p>
<p>Both when running a chunk with a ggplot2 plot interactively in the <code>.Rmd</code> file and when knitting the <code>.Rmd</code> to a PDF, the plot typeface will be Fira Sans.
And we are done.</p>
</div>
<div id="extra-saving-ggplot2-plots-to-a-file" class="section level2">
<h2>Extra: Saving ggplot2 plots to a file</h2>
<p>Now, what if you want to save the plots with your custom typeface to a file that you can include in another document?</p>
<p>You have two options:</p>
<ul>
<li>You can save the plot as a standalone PDF file (with embedded fonts).</li>
<li>Or you can save the plot as a <code>.png</code> image.</li>
</ul>
<p>Achieving that is quite simple with <code>ggsave()</code>:</p>
<pre class="r"><code># let&#39;s prepare a plot which will use our custom fonts
p &lt;- ggplot(mpg, aes(class)) +
  geom_bar()

# save to pdf
ggsave(p, &quot;./plot.pdf&quot;, device = cairo_pdf, width = 7, height = 5)

# save to png
ggsave(p, &quot;./plot.png&quot;, width = 7, height = 5)</code></pre>
<p>The magic is done by <code>ggsave(..., device = cairo_pdf)</code> (that’s the same <code>cairo_pdf</code> device we set in the YAML preamble).
Note that it’s <code>cairo_pdf</code> and not <code>cairo_pdf()</code> (for reasons beyond my comprehension, it does not work if you add the parentheses).</p>
<p>Here you find a <a href="https://gist.github.com/stefanocoretta/c9e3c0d8a72739c7ebb3a30d11e4c134">gist</a> with an example <code>.Rmd</code> file that you can download on your machine and knit as a test.</p>
</div>
<div id="supported-fonts" class="section level2">
<h2>Supported fonts</h2>
<p>As far as I can tell, any <code>.ttf</code> (TrueType font) installed on your system with Font Book can be set as the typeface to be used in the ggplot2 plots.</p>
</div>
<div id="session-info" class="section level2">
<h2>Session info</h2>
<pre class="r"><code>devtools::session_info()</code></pre>
<pre><code>## ─ Session info ───────────────────────────────────────────────────────────────
##  setting  value
##  version  R version 4.2.2 (2022-10-31)
##  os       macOS Ventura 13.1
##  system   aarch64, darwin20
##  ui       X11
##  language (EN)
##  collate  en_US.UTF-8
##  ctype    en_US.UTF-8
##  tz       Europe/London
##  date     2023-01-22
##  pandoc   2.19.2 @ /Applications/RStudio.app/Contents/Resources/app/quarto/bin/tools/ (via rmarkdown)
## 
## ─ Packages ───────────────────────────────────────────────────────────────────
##  ! package     * version date (UTC) lib source
##  P blogdown      1.16    2022-12-13 [?] CRAN (R 4.2.0)
##  P bookdown      0.32    2023-01-17 [?] CRAN (R 4.2.0)
##  P bslib         0.4.2   2022-12-16 [?] CRAN (R 4.2.0)
##  P cachem        1.0.6   2021-08-19 [?] CRAN (R 4.2.0)
##  P callr         3.7.3   2022-11-02 [?] CRAN (R 4.2.0)
##  P cli           3.6.0   2023-01-09 [?] CRAN (R 4.2.0)
##  P crayon        1.5.2   2022-09-29 [?] CRAN (R 4.2.0)
##  P devtools      2.4.5   2022-10-11 [?] CRAN (R 4.2.0)
##  P digest        0.6.31  2022-12-11 [?] CRAN (R 4.2.0)
##  P ellipsis      0.3.2   2021-04-29 [?] CRAN (R 4.2.0)
##  P evaluate      0.20    2023-01-17 [?] CRAN (R 4.2.2)
##  P fastmap       1.1.0   2021-01-25 [?] CRAN (R 4.2.0)
##  P fs            1.5.2   2021-12-08 [?] CRAN (R 4.2.0)
##  P glue          1.6.2   2022-02-24 [?] CRAN (R 4.2.0)
##  P htmltools     0.5.4   2022-12-07 [?] CRAN (R 4.2.0)
##  P htmlwidgets   1.6.1   2023-01-07 [?] CRAN (R 4.2.0)
##  P httpuv        1.6.8   2023-01-12 [?] CRAN (R 4.2.0)
##  P jquerylib     0.1.4   2021-04-26 [?] CRAN (R 4.2.0)
##  P jsonlite      1.8.4   2022-12-06 [?] CRAN (R 4.2.0)
##  P knitr         1.41    2022-11-18 [?] CRAN (R 4.2.0)
##  P later         1.3.0   2021-08-18 [?] CRAN (R 4.2.0)
##  P lifecycle     1.0.3   2022-10-07 [?] CRAN (R 4.2.1)
##  P magrittr      2.0.3   2022-03-30 [?] CRAN (R 4.2.0)
##  P memoise       2.0.1   2021-11-26 [?] CRAN (R 4.2.0)
##  P mime          0.12    2021-09-28 [?] CRAN (R 4.2.0)
##  P miniUI        0.1.1.1 2018-05-18 [?] CRAN (R 4.2.0)
##  P pkgbuild      1.4.0   2022-11-27 [?] CRAN (R 4.2.0)
##  P pkgload       1.3.2   2022-11-16 [?] CRAN (R 4.2.0)
##  P prettyunits   1.1.1   2020-01-24 [?] CRAN (R 4.2.0)
##  P processx      3.8.0   2022-10-26 [?] CRAN (R 4.2.0)
##  P profvis       0.3.7   2020-11-02 [?] CRAN (R 4.2.0)
##  P promises      1.2.0.1 2021-02-11 [?] CRAN (R 4.2.0)
##  P ps            1.7.2   2022-10-26 [?] CRAN (R 4.2.0)
##  P purrr         1.0.1   2023-01-10 [?] CRAN (R 4.2.0)
##  P R6            2.5.1   2021-08-19 [?] CRAN (R 4.2.0)
##  P Rcpp          1.0.9   2022-07-08 [?] CRAN (R 4.2.1)
##  P remotes       2.4.2   2021-11-30 [?] CRAN (R 4.2.0)
##  P renv          0.16.0  2022-09-29 [?] CRAN (R 4.2.0)
##  P rlang         1.0.6   2022-09-24 [?] CRAN (R 4.2.1)
##  P rmarkdown     2.20    2023-01-19 [?] CRAN (R 4.2.2)
##  P rstudioapi    0.14    2022-08-22 [?] CRAN (R 4.2.0)
##  P sass          0.4.4   2022-11-24 [?] CRAN (R 4.2.2)
##  P sessioninfo   1.2.2   2021-12-06 [?] CRAN (R 4.2.0)
##  P shiny         1.7.4   2022-12-15 [?] CRAN (R 4.2.2)
##  P stringi       1.7.12  2023-01-11 [?] CRAN (R 4.2.0)
##  P stringr       1.5.0   2022-12-02 [?] CRAN (R 4.2.2)
##  P urlchecker    1.0.1   2021-11-30 [?] CRAN (R 4.2.0)
##  P usethis       2.1.6   2022-05-25 [?] CRAN (R 4.2.0)
##  P vctrs         0.5.1   2022-11-16 [?] CRAN (R 4.2.0)
##  P xfun          0.36    2022-12-21 [?] CRAN (R 4.2.0)
##  P xtable        1.8-4   2019-04-21 [?] CRAN (R 4.2.0)
##  P yaml          2.3.6   2022-10-18 [?] CRAN (R 4.2.0)
## 
##  [1] /Users/ste/repos/stefanocoretta.github.io/renv/library/R-4.2/aarch64-apple-darwin20
##  [2] /Users/ste/repos/stefanocoretta.github.io/renv/sandbox/R-4.2/aarch64-apple-darwin20/84ba8b13
## 
##  P ── Loaded and on-disk path mismatch.
## 
## ──────────────────────────────────────────────────────────────────────────────</code></pre>
</div>
<div class="footnotes footnotes-end-of-document">
<hr />
<ol>
<li id="fn1"><p><a href="https://media.giphy.com/media/3o6gDY8zzwvNQdFCaQ/giphy.gif" class="uri">https://media.giphy.com/media/3o6gDY8zzwvNQdFCaQ/giphy.gif</a><a href="#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
