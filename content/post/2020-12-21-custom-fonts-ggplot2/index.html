---
title: How to use custom typefaces in ggplot2 [macOS only]
author: Stefano Coretta
date: '2020-12-21'
slug: custom-fonts-ggplot2
categories:
  - Methods
tags:
  - data viz
  - ggplot2
  - ipa
  - typefaces
  - fonts
---

<script src="{{< blogdown/postref >}}index_files/header-attrs/header-attrs.js"></script>


<p>I keep hitting my head against this particular (and seemingly simple) task: <strong>using custom typefaces in ggplot2 plots</strong> and <strong>being able to knit to PDF</strong>.</p>
<p>The main reason for why I would want to do that is that I often find myself in need of including <a href="https://www.internationalphoneticassociation.org/content/ipa-chart">IPA</a> symbols in plots (more often than not, it’s vowels) and that I want those plots to be included in a knitted PDF.</p>
<p>For some reason, when I think I got it, I have to search again because the solution I previously found no longer works.</p>
<p>So now I took the time to play around with different options and packages, and I found the minimal configuration one needs to use custom typefaces in ggplot2 plots and get a PDF document with those plots embedded in it (it is working as of December 2020, not sure what the year will bring).</p>
<p>In the following sections I will show what this configuration looks like.
Note that this post covers only R running on macOS and that things will be different perhaps on Linux and for sure on Windows (maybe I’ll cover those OSs in an update later on).</p>
<p>You can check out my full session info below, but just be aware that I am using R 4.0.3 in macOS Big Sur 11.1, with the latest version of the tidyverse packages at the time of writing.</p>
<div id="enable-custom-typefaces-in-ggplot2-plots-when-knitting-to-pdf" class="section level2">
<h2>Enable custom typefaces in ggplot2 plots when knitting to PDF</h2>
<p>I was surprised to find out that to include custom typefaces in ggplot2 plots and knit the <code>.Rmd</code> to a PDF document, you just need the following options in your YAML preamble (no need for extra packages!!!).</p>
<pre class="r"><code>---
output:
  pdf_document:
    latex_engine: xelatex
    dev: cairo_pdf
---</code></pre>
<p>In particular, the <code>dev</code> option sets <code>cairo_pdf()</code> (shipped with ggplot2) as the default device for rendering the plots within the knitted PDF document.</p>
<p>As Miranda Priestly would say, <em>that’s all…</em><a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a></p>
<p>Within your document you can then specify the typeface you want to use in the plots.
The most straightforward way is to set a ggplot2 theme and specify the <code>base_family</code> argument.</p>
<pre class="r"><code>library(tidyverse) # or library(ggplot2)
theme_set(theme_light(base_family = &quot;Fira Sans&quot;))</code></pre>
<p>I chose the <a href="https://fonts.google.com/specimen/Fira+Sans">Fira Sans</a> fonts here because they include the Unicode range of the IPA.</p>
<p>Both when running a chunk with a ggplot2 plot interactively in the <code>.Rmd</code> file and when knitting the <code>.Rmd</code> to a PDF, the plot typeface will be Fira Sans.
And we are done.</p>
</div>
<div id="extra-saving-ggplot2-plots-to-a-file" class="section level2">
<h2>Extra: Saving ggplot2 plots to a file</h2>
<p>Now, what if you want to save the plots with your custom typeface to a file that you can include in another document?</p>
<p>You have two options:</p>
<ul>
<li>You can save the plot as a standalone PDF file (with embedded fonts).</li>
<li>Or you can save the plot as a <code>.png</code> image.</li>
</ul>
<p>Achieving that is quite simple with <code>ggsave()</code>:</p>
<pre class="r"><code># let&#39;s prepare a plot which will use our custom fonts
p &lt;- ggplot(mpg, aes(class)) +
  geom_bar()

# save to pdf
ggsave(p, &quot;./plot.pdf&quot;, device = cairo_pdf, width = 7, height = 5)

# save to png
ggsave(p, &quot;./plot.png&quot;, width = 7, height = 5)</code></pre>
<p>The magic is done by <code>ggsave(..., device = cairo_pdf)</code> (that’s the same <code>cairo_pdf</code> device we set in the YAML preamble).
Note that it’s <code>cairo_pdf</code> and not <code>cairo_pdf()</code> (for reasons beyond my comprehension, it does not work if you add the parentheses).</p>
<p>Here you find a <a href="https://gist.github.com/stefanocoretta/c9e3c0d8a72739c7ebb3a30d11e4c134">gist</a> with an example <code>.Rmd</code> file that you can download on your machine and knit as a test.</p>
</div>
<div id="supported-fonts" class="section level2">
<h2>Supported fonts</h2>
<p>As far as I can tell, any <code>.ttf</code> (TrueType font) installed on your system with Font Book can be set as the typeface to be used in the ggplot2 plots.</p>
</div>
<div id="session-info" class="section level2">
<h2>Session info</h2>
<pre class="r"><code>devtools::session_info()</code></pre>
<pre><code>## ─ Session info ───────────────────────────────────────────────────────────────
##  setting  value                       
##  version  R version 4.1.0 (2021-05-18)
##  os       macOS Big Sur 10.16         
##  system   x86_64, darwin17.0          
##  ui       X11                         
##  language (EN)                        
##  collate  en_US.UTF-8                 
##  ctype    en_GB.UTF-8                 
##  tz       Europe/Berlin               
##  date     2021-05-29                  
## 
## ─ Packages ───────────────────────────────────────────────────────────────────
##  ! package     * version date       lib source        
##  P assertthat    0.2.1   2019-03-21 [?] CRAN (R 4.1.0)
##  P blogdown      1.2     2021-03-04 [?] CRAN (R 4.1.0)
##  P bookdown      0.21    2020-10-13 [?] CRAN (R 4.1.0)
##  P bslib         0.2.4   2021-01-25 [?] CRAN (R 4.1.0)
##  P cachem        1.0.4   2021-02-13 [?] CRAN (R 4.1.0)
##  P callr         3.5.1   2020-10-13 [?] CRAN (R 4.1.0)
##  P cli           2.3.1   2021-02-23 [?] CRAN (R 4.1.0)
##  P crayon        1.4.1   2021-02-08 [?] CRAN (R 4.1.0)
##  P desc          1.3.0   2021-03-05 [?] CRAN (R 4.1.0)
##  P devtools      2.3.2   2020-09-18 [?] CRAN (R 4.1.0)
##  P digest        0.6.27  2020-10-24 [?] CRAN (R 4.1.0)
##  P ellipsis      0.3.1   2020-05-15 [?] CRAN (R 4.1.0)
##  P evaluate      0.14    2019-05-28 [?] CRAN (R 4.1.0)
##  P fastmap       1.1.0   2021-01-25 [?] CRAN (R 4.1.0)
##  P fs            1.5.0   2020-07-31 [?] CRAN (R 4.1.0)
##  P glue          1.4.2   2020-08-27 [?] CRAN (R 4.1.0)
##  P htmltools     0.5.1.1 2021-01-22 [?] CRAN (R 4.1.0)
##  P jquerylib     0.1.3   2020-12-17 [?] CRAN (R 4.1.0)
##  P jsonlite      1.7.2   2020-12-09 [?] CRAN (R 4.1.0)
##  P knitr         1.31    2021-01-27 [?] CRAN (R 4.1.0)
##  P lifecycle     1.0.0   2021-02-15 [?] CRAN (R 4.1.0)
##  P magrittr      2.0.1   2020-11-17 [?] CRAN (R 4.1.0)
##  P memoise       2.0.0   2021-01-26 [?] CRAN (R 4.1.0)
##  P pkgbuild      1.2.0   2020-12-15 [?] CRAN (R 4.1.0)
##  P pkgload       1.2.0   2021-02-23 [?] CRAN (R 4.1.0)
##  P prettyunits   1.1.1   2020-01-24 [?] CRAN (R 4.1.0)
##  P processx      3.4.5   2020-11-30 [?] CRAN (R 4.1.0)
##  P ps            1.6.0   2021-02-28 [?] CRAN (R 4.1.0)
##  P purrr         0.3.4   2020-04-17 [?] CRAN (R 4.1.0)
##  P R6            2.5.0   2020-10-28 [?] CRAN (R 4.1.0)
##  P remotes       2.2.0   2020-07-21 [?] CRAN (R 4.1.0)
##    renv          0.13.1  2021-03-18 [1] CRAN (R 4.1.0)
##  P rlang         0.4.10  2020-12-30 [?] CRAN (R 4.1.0)
##  P rmarkdown     2.7     2021-02-19 [?] CRAN (R 4.1.0)
##  P rprojroot     2.0.2   2020-11-15 [?] CRAN (R 4.1.0)
##  P sass          0.3.1   2021-01-24 [?] CRAN (R 4.1.0)
##  P sessioninfo   1.1.1   2018-11-05 [?] CRAN (R 4.1.0)
##  P stringi       1.5.3   2020-09-09 [?] CRAN (R 4.1.0)
##  P stringr       1.4.0   2019-02-10 [?] CRAN (R 4.1.0)
##  P testthat      3.0.2   2021-02-14 [?] CRAN (R 4.1.0)
##  P usethis       2.0.1   2021-02-10 [?] CRAN (R 4.1.0)
##  P withr         2.4.1   2021-01-26 [?] CRAN (R 4.1.0)
##  P xfun          0.22    2021-03-11 [?] CRAN (R 4.1.0)
##  P yaml          2.2.1   2020-02-01 [?] CRAN (R 4.1.0)
## 
## [1] /Users/ste/repos/web/stefanocoretta.github.io/renv/library/R-4.1/x86_64-apple-darwin17.0
## [2] /private/var/folders/yj/b5zvw9lj2zg6tp920wyg14y80000gn/T/Rtmph17NxV/renv-system-library
## 
##  P ── Loaded and on-disk path mismatch.</code></pre>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p><a href="https://media.giphy.com/media/3o6gDY8zzwvNQdFCaQ/giphy.gif" class="uri">https://media.giphy.com/media/3o6gDY8zzwvNQdFCaQ/giphy.gif</a><a href="#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
