<!DOCTYPE html>
<html lang="en-uk">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="theme" content="hugo-academic">
  <meta name="generator" content="Hugo 0.47.1" />
  <meta name="author" content="Stefano Coretta">
  <meta name="description" content="PhD student in Linguistics">

  
  <link rel="alternate" hreflang="en-uk" href="https://stefanocoretta.github.io/post/vowel-formants-trajectories-and-tidy-data/">

  
  


  

  
  
  
  
    
  
  
    
    
      
        <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
      
    
  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha512-6MXa8B6uaO18Hid6blRMetEIoPqHf7Ux1tnyIQdpt9qI5OACx7C+O3IVTr98vwGnlcg0LOLa02i9Y1HpVhlfiw==" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.1/css/academicons.min.css" integrity="sha512-NThgw3XKQ1absAahW6to7Ey42uycrVvfNfyjqcFNgCmOCQ5AR4AO0SiXrN+8ZtYeappp56lk1WtvjVmEa+VR6A==" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha512-SfTiTlX6kk+qitfevl/7LibUOeJWlt9rbyDn92a1DqWOw9vWG2MFoays0sgObmWazO5BQPiFucnnEAjpAB+/Sw==" crossorigin="anonymous">
  
  
  
  
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Montserrat:400,700%7cRoboto:400,400italic,700%7cRoboto&#43;Mono">
  
  <link rel="stylesheet" href="/styles.css">
  
  <link rel="stylesheet" href="/css/custom.css">
  

  

  
  <link rel="alternate" href="https://stefanocoretta.github.io/index.xml" type="application/rss+xml" title="Stefano Coretta">
  <link rel="feed" href="https://stefanocoretta.github.io/index.xml" type="application/rss+xml" title="Stefano Coretta">
  

  <link rel="manifest" href="/site.webmanifest">
  <link rel="icon" type="image/png" href="/img/icon.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/icon-192.png">

  <link rel="canonical" href="https://stefanocoretta.github.io/post/vowel-formants-trajectories-and-tidy-data/">

  <meta property="twitter:card" content="summary_large_image">
  
  <meta property="twitter:site" content="@StefanoCoretta">
  <meta property="twitter:creator" content="@StefanoCoretta">
  
  <meta property="og:site_name" content="Stefano Coretta">
  <meta property="og:url" content="https://stefanocoretta.github.io/post/vowel-formants-trajectories-and-tidy-data/">
  <meta property="og:title" content="Vowel formants trajectories and tidy data | Stefano Coretta">
  <meta property="og:description" content="">
  <meta property="og:locale" content="en-uk">
  
  <meta property="article:published_time" content="2018-03-02T00:00:00&#43;00:00">
  
  <meta property="article:modified_time" content="2018-03-02T00:00:00&#43;00:00">
  

  

  <title>Vowel formants trajectories and tidy data | Stefano Coretta</title>

</head>
<body id="top" data-spy="scroll" data-target="#toc" data-offset="71" >

<nav class="navbar navbar-default navbar-fixed-top" id="navbar-main">
  <div class="container">

    
    <div class="navbar-header">
      
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
              data-target=".navbar-collapse" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      
      <a class="navbar-brand" href="/">Stefano Coretta</a>
    </div>

    
    <div class="collapse navbar-collapse">

      
      
      <ul class="nav navbar-nav navbar-right">
        

        

        
          
        

        <li class="nav-item">
          <a href="/#about">
            
            <span>Home</span>
            
          </a>
        </li>

        
        

        

        
          
        

        <li class="nav-item">
          <a href="/research">
            
            <span>Research</span>
            
          </a>
        </li>

        
        

        

        
          
        

        <li class="nav-item">
          <a href="/output">
            
            <span>Output</span>
            
          </a>
        </li>

        
        

        

        
          
        

        <li class="nav-item">
          <a href="/post">
            
            <span>Blog</span>
            
          </a>
        </li>

        
        

        

        
          
        

        <li class="nav-item">
          <a href="/docs/CorettaCV.pdf">
            
            <span>CV</span>
            
          </a>
        </li>

        
        
      

      
      </ul>

    </div>
  </div>
</nav>


<article class="article" itemscope itemtype="http://schema.org/Article">

  


  <div class="article-container">
    <div class="article-inner">
      <h1 itemprop="name">Vowel formants trajectories and tidy data</h1>

      

<div class="article-metadata">

  
  <span class="article-date">
    
    <time datetime="2018-03-02 00:00:00 &#43;0000 UTC" itemprop="datePublished">
      02 March 2018
    </time>
  </span>
  

  
  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    6 min read
  </span>
  
  

  
  

  
  
  
  <span class="middot-divider"></span>
  <span class="article-categories">
    <i class="fa fa-folder"></i>
    
    <a href="/categories/linguistics">Linguistics</a
    >
    
  </span>
  
  

  
  
<div class="share-box" aria-hidden="true">
  <ul class="share">
    <li>
      <a class="twitter"
         href="https://twitter.com/intent/tweet?text=Vowel%20formants%20trajectories%20and%20tidy%20data&amp;url=https%3a%2f%2fstefanocoretta.github.io%2fpost%2fvowel-formants-trajectories-and-tidy-data%2f"
         target="_blank" rel="noopener">
        <i class="fa fa-twitter"></i>
      </a>
    </li>
    <li>
      <a class="facebook"
         href="https://www.facebook.com/sharer.php?u=https%3a%2f%2fstefanocoretta.github.io%2fpost%2fvowel-formants-trajectories-and-tidy-data%2f"
         target="_blank" rel="noopener">
        <i class="fa fa-facebook"></i>
      </a>
    </li>
    <li>
      <a class="linkedin"
         href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fstefanocoretta.github.io%2fpost%2fvowel-formants-trajectories-and-tidy-data%2f&amp;title=Vowel%20formants%20trajectories%20and%20tidy%20data"
         target="_blank" rel="noopener">
        <i class="fa fa-linkedin"></i>
      </a>
    </li>
    <li>
      <a class="weibo"
         href="http://service.weibo.com/share/share.php?url=https%3a%2f%2fstefanocoretta.github.io%2fpost%2fvowel-formants-trajectories-and-tidy-data%2f&amp;title=Vowel%20formants%20trajectories%20and%20tidy%20data"
         target="_blank" rel="noopener">
        <i class="fa fa-weibo"></i>
      </a>
    </li>
    <li>
      <a class="email"
         href="mailto:?subject=Vowel%20formants%20trajectories%20and%20tidy%20data&amp;body=https%3a%2f%2fstefanocoretta.github.io%2fpost%2fvowel-formants-trajectories-and-tidy-data%2f">
        <i class="fa fa-envelope"></i>
      </a>
    </li>
  </ul>
</div>


  

</div>


      <div class="article-style" itemprop="articleBody">
        <p>With the advent of more powerful statistical methods for accessing time series data, it is now more common to compare whole vowel formant trajectories rather then just using average formant values.</p>
<p>Sometimes, the output of the Praat script used for extracting formats data gives us a ‘wide format’ dataset. In this format, separate columns contain formant values for each interval within the vowel. Normally, values are extracted every 10% or 5% intervals within the vowel.</p>
<p>To work with formant trajectories data in <code>R</code>, we need instead a ‘long format’ dataset. In a long format dataset, the percent intervals are layed out in rows, rather then columns.</p>
<p>We start by reading in the formant data, which were kindly provided by <a href="http://tiny.cc/sjn">Stephen Nichols</a>.</p>
<pre class="r"><code>trajectories &lt;- read_csv(&quot;./static/data/nichols-2018/tulemupepelako.csv&quot;)</code></pre>
<pre><code>## Parsed with column specification:
## cols(
##   .default = col_double(),
##   Vowel = col_character(),
##   Word = col_character()
## )</code></pre>
<pre><code>## See spec(...) for full column specifications.</code></pre>
<pre class="r"><code>trajectories</code></pre>
<pre><code>## # A tibble: 7 x 61
##    Time Vowel Word  Duration F1_05 F1_10 F1_15 F1_20 F1_25 F1_30 F1_35
##   &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1  194. u     tule…     43.3  406.  439.  453.  456.  430.  357.  314.
## 2  194. e     tule…    103.   503.  517.  537.  564.  556.  362.  315.
## 3  194. u     tule…     14.1  290.  288.  286.  283.  281.  281.  282.
## 4  194. e     tule…     75.7  440.  441.  439.  429.  386.  269.  250.
## 5  194. e     tule…     68.2  437.  445.  479.  562.  622.  605.  523.
## 6  195. a     tule…     89.8  800.  736.  662.  543.  447.  564.  768.
## 7  195. o     tule…     98.5  482.  463.  471.  326.  316.  573. 1511.
## # ... with 50 more variables: F1_40 &lt;dbl&gt;, F1_45 &lt;dbl&gt;, F1_50 &lt;dbl&gt;,
## #   F1_55 &lt;dbl&gt;, F1_60 &lt;dbl&gt;, F1_65 &lt;dbl&gt;, F1_70 &lt;dbl&gt;, F1_75 &lt;dbl&gt;,
## #   F1_80 &lt;dbl&gt;, F1_85 &lt;dbl&gt;, F1_90 &lt;dbl&gt;, F1_95 &lt;dbl&gt;, F2_05 &lt;dbl&gt;,
## #   F2_10 &lt;dbl&gt;, F2_15 &lt;dbl&gt;, F2_20 &lt;dbl&gt;, F2_25 &lt;dbl&gt;, F2_30 &lt;dbl&gt;,
## #   F2_35 &lt;dbl&gt;, F2_40 &lt;dbl&gt;, F2_45 &lt;dbl&gt;, F2_50 &lt;dbl&gt;, F2_55 &lt;dbl&gt;,
## #   F2_60 &lt;dbl&gt;, F2_65 &lt;dbl&gt;, F2_70 &lt;dbl&gt;, F2_75 &lt;dbl&gt;, F2_80 &lt;dbl&gt;,
## #   F2_85 &lt;dbl&gt;, F2_90 &lt;dbl&gt;, F2_95 &lt;dbl&gt;, F3_05 &lt;dbl&gt;, F3_10 &lt;dbl&gt;,
## #   F3_15 &lt;dbl&gt;, F3_20 &lt;dbl&gt;, F3_25 &lt;dbl&gt;, F3_30 &lt;dbl&gt;, F3_35 &lt;dbl&gt;,
## #   F3_40 &lt;dbl&gt;, F3_45 &lt;dbl&gt;, F3_50 &lt;dbl&gt;, F3_55 &lt;dbl&gt;, F3_60 &lt;dbl&gt;,
## #   F3_65 &lt;dbl&gt;, F3_70 &lt;dbl&gt;, F3_75 &lt;dbl&gt;, F3_80 &lt;dbl&gt;, F3_85 &lt;dbl&gt;,
## #   F3_90 &lt;dbl&gt;, F3_95 &lt;dbl&gt;</code></pre>
<p>The dataset contains formant values of F1-F3 at 5% intervals for the vowels of the word <em>tulemupepelako</em> ‘we are praying for her’ (Bemba, [<code>bemb1257</code>]). It’s a toy dataset of course, just for purpose of illustration, so not very exciting!</p>
<p>The values for each 5% interval for each formant are in separate columns. For plotting and modelling, though, we need the data to be in a ‘tidy’ format <span class="citation">(Wickham 2014)</span>:</p>
<ul>
<li>each observation unit is in a separate row</li>
<li>each variable is a separate column</li>
</ul>
<p>In our case, each observation unit is a 5% interval. As for the variables, they are: time in the recording, word, vowel, vowel duration, F1, F2, and F3.</p>
<p>The first step towards a long format data set is to gather all the columns that have formant values to a column indicating the formant plus interval (like ‘F1_05’) and the value of that formant in that interval. We can use <code>gather()</code> for this.</p>
<p>In the following chunks, I will illustrate the results of each step separately by saving the output of the functions to variables. Later in this post, you’ll find a pipe chain with all functions without intermediate outputs.</p>
<pre class="r"><code>trajectories_gath &lt;- gather(trajectories, &quot;formant&quot;, &quot;value&quot;, F1_05:F3_95)
trajectories_gath</code></pre>
<pre><code>## # A tibble: 399 x 6
##     Time Vowel Word           Duration formant value
##    &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;             &lt;dbl&gt; &lt;chr&gt;   &lt;dbl&gt;
##  1  194. u     tulemupepelako     43.3 F1_05    406.
##  2  194. e     tulemupepelako    103.  F1_05    503.
##  3  194. u     tulemupepelako     14.1 F1_05    290.
##  4  194. e     tulemupepelako     75.7 F1_05    440.
##  5  194. e     tulemupepelako     68.2 F1_05    437.
##  6  195. a     tulemupepelako     89.8 F1_05    800.
##  7  195. o     tulemupepelako     98.5 F1_05    482.
##  8  194. u     tulemupepelako     43.3 F1_10    439.
##  9  194. e     tulemupepelako    103.  F1_10    517.
## 10  194. u     tulemupepelako     14.1 F1_10    288.
## # ... with 389 more rows</code></pre>
<p>Now we have a column <code>formant</code> with the formant plus interval label, and a column <code>value</code> with its value (in Hertz in our case).</p>
<p>The next step is to separate the label of the formant plus interval into two separate columns: one for <code>formant</code>, and one for <code>interval</code>.</p>
<pre class="r"><code>trajectories_sep &lt;- separate(trajectories_gath, formant, c(&quot;formant&quot;, &quot;interval&quot;), convert = TRUE)
trajectories_sep</code></pre>
<pre><code>## # A tibble: 399 x 7
##     Time Vowel Word           Duration formant interval value
##    &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;             &lt;dbl&gt; &lt;chr&gt;      &lt;int&gt; &lt;dbl&gt;
##  1  194. u     tulemupepelako     43.3 F1             5  406.
##  2  194. e     tulemupepelako    103.  F1             5  503.
##  3  194. u     tulemupepelako     14.1 F1             5  290.
##  4  194. e     tulemupepelako     75.7 F1             5  440.
##  5  194. e     tulemupepelako     68.2 F1             5  437.
##  6  195. a     tulemupepelako     89.8 F1             5  800.
##  7  195. o     tulemupepelako     98.5 F1             5  482.
##  8  194. u     tulemupepelako     43.3 F1            10  439.
##  9  194. e     tulemupepelako    103.  F1            10  517.
## 10  194. u     tulemupepelako     14.1 F1            10  288.
## # ... with 389 more rows</code></pre>
<p>Now we can create individual columns for each formant from F1 to F3. We can achieve this with <code>spread()</code>.</p>
<pre class="r"><code>trajectories_spr &lt;- spread(trajectories_sep, formant, value)
trajectories_spr</code></pre>
<pre><code>## # A tibble: 133 x 8
##     Time Vowel Word           Duration interval    F1    F2    F3
##    &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;             &lt;dbl&gt;    &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1  194. u     tulemupepelako     43.3        5  406. 1205. 2626.
##  2  194. u     tulemupepelako     43.3       10  439. 1226. 2556.
##  3  194. u     tulemupepelako     43.3       15  453. 1246. 2507.
##  4  194. u     tulemupepelako     43.3       20  456. 1291. 2451.
##  5  194. u     tulemupepelako     43.3       25  430. 1418. 2331.
##  6  194. u     tulemupepelako     43.3       30  357. 1555. 2268.
##  7  194. u     tulemupepelako     43.3       35  314. 1603. 2335.
##  8  194. u     tulemupepelako     43.3       40  288. 1709. 2437.
##  9  194. u     tulemupepelako     43.3       45  286. 1712. 2461.
## 10  194. u     tulemupepelako     43.3       50  327. 1747. 2470.
## # ... with 123 more rows</code></pre>
<p>What we have now is a long format dataset, with separate columns for each formant, and individual rows for each vowel interval.</p>
<div id="the-pipe-chain" class="section level2">
<h2>The pipe chain</h2>
<p>All the steps above can be chained by using the pipe <code>%&gt;%</code>.</p>
<pre class="r"><code>trajectories &lt;- trajectories %&gt;%
  gather(&quot;formant&quot;, &quot;value&quot;, F1_05:F3_95) %&gt;%
  separate(formant, c(&quot;formant&quot;, &quot;interval&quot;), convert = TRUE) %&gt;%
  spread(formant, value)</code></pre>
<p>We can finally easily plot the formant trajectories.</p>
<pre class="r"><code>trajectories %&gt;%
  ggplot(aes(x = interval)) +
  geom_smooth(aes(y = F1), se = FALSE, colour = &quot;red&quot;) +
  geom_smooth(aes(y = F2), se = FALSE, colour = &quot;green&quot;) +
  geom_smooth(aes(y = F3), se = FALSE, colour = &quot;blue&quot;) +
  facet_wrap(~ Vowel) +
  ylab(&quot;Hertz&quot;)</code></pre>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;
## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;
## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="/post/2018-03-02-vowel-formants-trajectories-and-tidy-data_files/figure-html/trajectory-plot-1.png" width="672" /></p>
</div>
<div id="references" class="section level2 unnumbered">
<h2>References</h2>
<div id="refs" class="references">
<div id="ref-wickham2014">
<p>Wickham, Hadley. 2014. “Tidy Data.” <em>Journal of Statistical Software</em> 59 (10). Foundation for Open Access Statistics: 1–23. doi:<a href="https://doi.org/10.18637/jss.v059.i10">10.18637/jss.v059.i10</a>.</p>
</div>
</div>
</div>

      </div>

      


<div class="article-tags">
  
  <a class="btn btn-primary btn-outline" href="/tags/rstats">rstats</a>
  
  <a class="btn btn-primary btn-outline" href="/tags/tidy-data">tidy data</a>
  
  <a class="btn btn-primary btn-outline" href="/tags/phonetics">phonetics</a>
  
  <a class="btn btn-primary btn-outline" href="/tags/phonology">phonology</a>
  
  <a class="btn btn-primary btn-outline" href="/tags/linguistics">linguistics</a>
  
  <a class="btn btn-primary btn-outline" href="/tags/data-processing">data processing</a>
  
  <a class="btn btn-primary btn-outline" href="/tags/time-series">time series</a>
  
  <a class="btn btn-primary btn-outline" href="/tags/formants">formants</a>
  
  <a class="btn btn-primary btn-outline" href="/tags/formant-trajectories">formant trajectories</a>
  
</div>



    </div>
  </div>

</article>



<div class="article-container article-widget">
  <div class="hr-light"></div>
  <h3>Related</h3>
  <ul>
    
    <li><a href="/post/2014-06-30-short-review-phonological-databases/">Short review of phonological databases</a></li>
    
  </ul>
</div>




<div class="article-container">
  

</div>

<footer class="site-footer">
  <div class="container">
    <p class="powered-by">

      &copy; 2017 Stefano Coretta &middot; 

      Powered by the
      <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
      <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

      <span class="pull-right" aria-hidden="true">
        <a href="#" id="back_to_top">
          <span class="button_icon">
            <i class="fa fa-chevron-up fa-2x"></i>
          </span>
        </a>
      </span>

    </p>
  </div>
</footer>


<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close btn-large" data-dismiss="modal">&times;</button>
        <h4 class="modal-title">Cite</h4>
      </div>
      <div>
        <pre><code class="modal-body tex"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-primary btn-outline js-copy-cite" href="#" target="_blank">
          <i class="fa fa-copy"></i> Copy
        </a>
        <a class="btn btn-primary btn-outline js-download-cite" href="#" target="_blank">
          <i class="fa fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

    

    
    

    

    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js" integrity="sha512-3P8rXCuGJdNZOnUx/03c1jOTnMn3rP63nBip5gOP2qmUh5YAdVAvFZ1E+QLZZbC1rtMrQb+mah3AfYW11RUrWA==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.3/imagesloaded.pkgd.min.js" integrity="sha512-umsR78NN0D23AzgoZ11K7raBD+R6hqKojyBZs1w8WvYlsI+QuKRGBx3LFCwhatzBunCjDuJpDHwxD13sLMbpRA==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha512-iztkobsvnjKfAtTNdHkGVjAYTrrtlC7mGp/54c40wowO7LhURYl3gVzzcEqGl/qKXQltJ2HwMrdLcNUdo+N/RQ==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.4/isotope.pkgd.min.js" integrity="sha512-VDBOIlDbuC4VWxGJNmuFRQ0Li0SKkDpmGyuhAG5LTDLd/dJ/S0WMVxriR2Y+CyPL5gzjpN4f/6iqWVBJlht0tQ==" crossorigin="anonymous"></script>
    
    
    <script src="/js/hugo-academic.js"></script>
    

    
    
      
      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js" integrity="sha256-/BfiIkHlHoVihZdc6TFuj7MmJ0TWcWsMXkeDFwhi0zw=" crossorigin="anonymous"></script>
      

      

      

      <script>hljs.initHighlightingOnLoad();</script>
    

    
    

  </body>
</html>

